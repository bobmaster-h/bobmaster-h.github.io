<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>多功能视频播放器</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 20px;
        }
        #player-container {
            max-width: 1000px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        #video {
            width: 100%;
            height: auto;
            max-height: 600px;
            background: #000;
            border-radius: 8px;
        }
        #current-title {
            margin: 15px 0;
            font-size: 20px;
            font-weight: bold;
        }
        .controls {
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        button, select {
            padding: 8px 15px;
            font-size: 16px;
            cursor: pointer;
        }
        #playlist {
            list-style: none;
            padding: 0;
            margin: 20px 0 0 0;
        }
        #playlist li {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }
        #playlist li:hover {
            background: #f5f5f5;
        }
        #playlist li.current {
            background: #e0f0ff;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div id="player-container">
    <video id="video" controls autoplay muted preload="metadata"></video>
    <div id="current-title">当前视频：美女视频1</div>
    
    <div class="controls">
        <button id="prev-btn">上一首</button>
        <button id="next-btn">下一首</button>
        <select id="play-mode">
            <option value="loop">循环播放（默认）</option>
            <option value="order">顺序播放</option>
            <option value="random">随机播放</option>
        </select>
    </div>
    
    <h3>播放列表（点击切换）</h3>
    <ul id="playlist"></ul>
</div>

<script>
    // 视频列表 - 请在这里替换为你真实的视频路径（示例中只有第一个是你的路径，其他两个是占位）
    const videoList = [
        { src: "/TG-2025-05-09-225147363.mp4", title: "美女视频1" },
        { src: "/example-video2.mp4", title: "美女视频2" },   // 请替换成真实路径
        { src: "/example-video3.mp4", title: "美女视频3" }    // 请替换成真实路径
        // 添加更多示例：
        // { src: "/your-new-video.mp4", title: "新视频名称" },
    ];

    let currentIndex = 0;
    const video = document.getElementById('video');
    const currentTitle = document.getElementById('current-title');
    const playlist = document.getElementById('playlist');
    const playMode = document.getElementById('play-mode');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');

    // 加载指定索引的视频
    function loadVideo(index) {
        if (index < 0 || index >= videoList.length) return;
        
        currentIndex = index;
        const v = videoList[index];
        video.innerHTML = `<source src="${v.src}" type="video/mp4">您的浏览器不支持视频播放。`;
        video.load();
        currentTitle.textContent = `当前视频：${v.title}`;
        
        // 更新播放列表高亮
        document.querySelectorAll('#playlist li').forEach((li, i) => {
            li.classList.toggle('current', i === index);
        });
    }

    // 获取下一个视频索引（根据播放模式）
    function getNextIndex() {
        if (playMode.value === "random") {
            let next = Math.floor(Math.random() * videoList.length);
            // 随机模式下避免立即重复同一首（可选）
            return next;
        } else {
            return (currentIndex + 1) % videoList.length;
        }
    }

    // 下一首
    function playNext() {
        let nextIndex;
        if (playMode.value === "order") {
            if (currentIndex >= videoList.length - 1) {
                return; // 顺序播放到最后一首就停止
            }
            nextIndex = currentIndex + 1;
        } else {
            nextIndex = getNextIndex();
        }
        loadVideo(nextIndex);
    }

    // 上一首
    function playPrev() {
        const prevIndex = (currentIndex - 1 + videoList.length) % videoList.length;
        loadVideo(prevIndex);
    }

    // 视频自然结束时处理
    video.addEventListener('ended', () => {
        if (playMode.value === "order" && currentIndex >= videoList.length - 1) {
            return; // 顺序播放最后一首结束就停止
        }
        playNext();
    });

    // 重要修复：如果视频路径无效（加载失败），自动跳到下一首（防止循环卡死）
    video.addEventListener('error', () => {
        console.warn(`视频加载失败：${videoList[currentIndex].src}，自动跳到下一首`);
        playNext();
    });

    // 初始化播放列表
    videoList.forEach((item, index) => {
        const li = document.createElement('li');
        li.textContent = item.title;
        li.onclick = () => loadVideo(index);
        playlist.appendChild(li);
    });

    // 按钮事件
    prevBtn.onclick = playPrev;
    nextBtn.onclick = playNext;

    // 默认加载第一首视频 + 默认循环模式 + autoplay/muted（保证自动播放下一首）
    playMode.value = "loop"; // 强制确保默认是循环
    loadVideo(0);
</script>

</body>
</html>
